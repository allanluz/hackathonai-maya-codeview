<div class="dashboard-container">
  <!-- Cabeçalho do Dashboard -->
  <div class="dashboard-header">
    <h1 class="dashboard-title">
      <mat-icon class="title-icon">dashboard</mat-icon>
      Dashboard MAYA
    </h1>
    <p class="dashboard-subtitle">
      Sistema de análise de código - Evertec
      <span class="last-update" *ngIf="lastUpdate">
        Última atualização: {{ lastUpdate | date:'dd/MM/yyyy HH:mm' }}
      </span>
    </p>
  </div>

  <!-- Cards de Métricas Principais -->
  <div class="metrics-grid">
    <mat-card class="metric-card total-reviews">
      <mat-card-content>
        <div class="metric-content">
          <div class="metric-value">{{ dashboardData?.totalReviews || 0 }}</div>
          <div class="metric-label">Total de Reviews</div>
        </div>
        <mat-icon class="metric-icon">assignment</mat-icon>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card active-reviews">
      <mat-card-content>
        <div class="metric-content">
          <div class="metric-value">{{ dashboardData?.activeReviews || 0 }}</div>
          <div class="metric-label">Reviews Ativos</div>
        </div>
        <mat-icon class="metric-icon">hourglass_empty</mat-icon>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card completed-today">
      <mat-card-content>
        <div class="metric-content">
          <div class="metric-value">{{ dashboardData?.completedToday || 0 }}</div>
          <div class="metric-label">Concluídos Hoje</div>
        </div>
        <mat-icon class="metric-icon">check_circle</mat-icon>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card average-score">
      <mat-card-content>
        <div class="metric-content">
          <div class="metric-value">{{ dashboardData?.averageScore || 0 }}%</div>
          <div class="metric-label">Score Médio</div>
        </div>
        <mat-icon class="metric-icon">grade</mat-icon>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Seção de Alertas e Issues -->
  <div class="alerts-section">
    <mat-card class="alerts-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>warning</mat-icon>
          Issues Críticos
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="alert-item connection-leaks" *ngIf="dashboardData?.connectionLeaksDetected">
          <mat-icon class="alert-icon">error</mat-icon>
          <div class="alert-content">
            <div class="alert-title">Vazamentos de Conexão Detectados</div>
            <div class="alert-description">
              {{ dashboardData?.connectionLeaksDetected }} vazamentos encontrados
            </div>
          </div>
          <button mat-icon-button color="warn">
            <mat-icon>arrow_forward</mat-icon>
          </button>
        </div>

        <div class="alert-item evertec-standards">
          <mat-icon class="alert-icon" [class]="getStandardsIconClass()">
            {{ getStandardsIcon() }}
          </mat-icon>
          <div class="alert-content">
            <div class="alert-title">Conformidade Padrões Evertec</div>
            <div class="alert-description">
              {{ dashboardData?.evertecStandardsCompliance || 0 }}% dos arquivos em conformidade
            </div>
          </div>
          <mat-progress-bar 
            mode="determinate" 
            [value]="dashboardData?.evertecStandardsCompliance || 0"
            class="standards-progress">
          </mat-progress-bar>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Status dos Serviços -->
    <mat-card class="services-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>settings_ethernet</mat-icon>
          Status dos Serviços
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="services-list">
          <div class="service-item" *ngFor="let service of getServicesList()">
            <mat-icon [class]="service.iconClass">{{ service.icon }}</mat-icon>
            <span class="service-name">{{ service.name }}</span>
            <mat-chip [class]="service.statusClass">{{ service.status }}</mat-chip>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Gráficos e Análises -->
  <div class="charts-section">
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>bar_chart</mat-icon>
          Análises Recentes
        </mat-card-title>
        <mat-card-subtitle>Últimos 7 dias</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-placeholder" *ngIf="!chartData">
          <mat-spinner diameter="40"></mat-spinner>
          <p>Carregando dados...</p>
        </div>
        <div class="chart-container" *ngIf="chartData">
          <!-- Aqui seria implementado o gráfico com ngx-charts -->
          <div class="simple-chart">
            <div class="chart-bars">
              <div class="chart-bar" *ngFor="let item of chartData" [style.height.%]="item.value">
                <span class="bar-label">{{ item.label }}</span>
                <span class="bar-value">{{ item.count }}</span>
              </div>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="summary-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>analytics</mat-icon>
          Resumo de Análises
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="summary-stats" *ngIf="analysisSummary">
          <div class="stat-item">
            <span class="stat-label">Arquivos Analisados</span>
            <span class="stat-value">{{ analysisSummary.filesAnalyzed }}/{{ analysisSummary.totalFiles }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Issues Encontrados</span>
            <span class="stat-value critical" *ngIf="analysisSummary.criticalIssues > 0">
              {{ analysisSummary.issuesFound }} ({{ analysisSummary.criticalIssues }} críticos)
            </span>
            <span class="stat-value" *ngIf="analysisSummary.criticalIssues === 0">
              {{ analysisSummary.issuesFound }}
            </span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Violações Padrão Evertec</span>
            <span class="stat-value">{{ analysisSummary.evertecPatternViolations }}</span>
          </div>
        </div>

        <div class="action-buttons">
          <button mat-raised-button color="primary" (click)="navigateToReviews()">
            <mat-icon>code</mat-icon>
            Ver Reviews
          </button>
          <button mat-raised-button color="accent" (click)="startNewReview()">
            <mat-icon>add</mat-icon>
            Novo Review
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Loading Spinner -->
  <div class="loading-container" *ngIf="isLoading">
    <mat-spinner diameter="60"></mat-spinner>
    <p>Carregando dashboard...</p>
  </div>
</div>
